[0m11:36:26.132913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a362d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a37170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a61a00>]}


============================== 11:36:26.141600 | d0261df6-9137-43e5-b26a-a85cf25911e4 ==============================
[0m11:36:26.141600 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:36:26.142498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'debug': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:36:26.143604 [info ] [MainThread]: dbt version: 1.7.11
[0m11:36:26.144194 [info ] [MainThread]: python version: 3.12.2
[0m11:36:26.144764 [info ] [MainThread]: python path: /Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt-env/bin/python3.12
[0m11:36:26.145346 [info ] [MainThread]: os info: macOS-12.7.3-x86_64-i386-64bit
[0m11:36:26.358548 [info ] [MainThread]: Using profiles dir at /Users/estelleclement/.dbt
[0m11:36:26.359265 [info ] [MainThread]: Using profiles.yml file at /Users/estelleclement/.dbt/profiles.yml
[0m11:36:26.359860 [info ] [MainThread]: Using dbt_project.yml file at /Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/dbt_project.yml
[0m11:36:26.361943 [info ] [MainThread]: adapter type: postgres
[0m11:36:26.362840 [info ] [MainThread]: adapter version: 1.7.11
[0m11:36:26.483137 [info ] [MainThread]: Configuration:
[0m11:36:26.483949 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:36:26.484572 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:36:26.485149 [info ] [MainThread]: Required dependencies:
[0m11:36:26.485796 [debug] [MainThread]: Executing "git --help"
[0m11:36:26.594832 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:36:26.596502 [debug] [MainThread]: STDERR: "b''"
[0m11:36:26.597393 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:36:26.597989 [info ] [MainThread]: Connection:
[0m11:36:26.598808 [info ] [MainThread]:   host: 10.4.251.244
[0m11:36:26.599493 [info ] [MainThread]:   port: 5432
[0m11:36:26.600477 [info ] [MainThread]:   user: postgres
[0m11:36:26.601351 [info ] [MainThread]:   database: postgres
[0m11:36:26.601907 [info ] [MainThread]:   schema: public
[0m11:36:26.602424 [info ] [MainThread]:   connect_timeout: 10
[0m11:36:26.603049 [info ] [MainThread]:   role: None
[0m11:36:26.603646 [info ] [MainThread]:   search_path: None
[0m11:36:26.604218 [info ] [MainThread]:   keepalives_idle: 0
[0m11:36:26.604762 [info ] [MainThread]:   sslmode: None
[0m11:36:26.605294 [info ] [MainThread]:   sslcert: None
[0m11:36:26.605807 [info ] [MainThread]:   sslkey: None
[0m11:36:26.606358 [info ] [MainThread]:   sslrootcert: None
[0m11:36:26.606934 [info ] [MainThread]:   application_name: dbt
[0m11:36:26.607801 [info ] [MainThread]:   retries: 1
[0m11:36:26.608765 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:36:26.640875 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:36:26.645822 [debug] [MainThread]: Using postgres connection "debug"
[0m11:36:26.646456 [debug] [MainThread]: On debug: select 1 as id
[0m11:36:26.646989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:36.661509 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "10.4.251.244", port 5432 failed: timeout expired

[0m11:36:36.665858 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m11:36:36.667131 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:36:36.668417 [debug] [MainThread]: On debug: No close available on handle
[0m11:36:36.670422 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:36:36.671551 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:36:36.672532 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "10.4.251.244", port 5432 failed: Host is down
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:36:36.682046 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 10.642457, "process_user_time": 3.243705, "process_kernel_time": 0.541413, "process_mem_max_rss": "92803072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:36:36.683344 [debug] [MainThread]: Command `dbt debug` failed at 11:36:36.683074 after 10.65 seconds
[0m11:36:36.684116 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:36:36.684888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae64b0>]}
[0m11:36:36.686165 [debug] [MainThread]: Flushing usage events
[0m11:37:40.295684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e17c0>]}


============================== 11:37:40.319129 | a482380d-dad4-4cb7-8b70-de2da8beb88f ==============================
[0m11:37:40.319129 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:37:40.322579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'version_check': 'True', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:37:40.324017 [info ] [MainThread]: dbt version: 1.7.11
[0m11:37:40.348792 [info ] [MainThread]: python version: 3.12.2
[0m11:37:40.354051 [info ] [MainThread]: python path: /Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt-env/bin/python3.12
[0m11:37:40.356243 [info ] [MainThread]: os info: macOS-12.7.3-x86_64-i386-64bit
[0m11:37:41.550499 [info ] [MainThread]: Using profiles dir at /Users/estelleclement/.dbt
[0m11:37:41.553976 [info ] [MainThread]: Using profiles.yml file at /Users/estelleclement/.dbt/profiles.yml
[0m11:37:41.555415 [info ] [MainThread]: Using dbt_project.yml file at /Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/dbt_project.yml
[0m11:37:41.604750 [info ] [MainThread]: adapter type: postgres
[0m11:37:41.630850 [info ] [MainThread]: adapter version: 1.7.11
[0m11:37:42.160933 [info ] [MainThread]: Configuration:
[0m11:37:42.163015 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:37:42.165068 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:37:42.166628 [info ] [MainThread]: Required dependencies:
[0m11:37:42.172009 [debug] [MainThread]: Executing "git --help"
[0m11:37:42.346662 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:37:42.349503 [debug] [MainThread]: STDERR: "b''"
[0m11:37:42.351072 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:37:42.352666 [info ] [MainThread]: Connection:
[0m11:37:42.354268 [info ] [MainThread]:   host: 10.4.251.244
[0m11:37:42.355602 [info ] [MainThread]:   port: 5432
[0m11:37:42.357228 [info ] [MainThread]:   user: postgres
[0m11:37:42.358985 [info ] [MainThread]:   database: postgres
[0m11:37:42.360204 [info ] [MainThread]:   schema: public
[0m11:37:42.361671 [info ] [MainThread]:   connect_timeout: 10
[0m11:37:42.363546 [info ] [MainThread]:   role: None
[0m11:37:42.365082 [info ] [MainThread]:   search_path: None
[0m11:37:42.372424 [info ] [MainThread]:   keepalives_idle: 0
[0m11:37:42.377532 [info ] [MainThread]:   sslmode: None
[0m11:37:42.379077 [info ] [MainThread]:   sslcert: None
[0m11:37:42.383943 [info ] [MainThread]:   sslkey: None
[0m11:37:42.385663 [info ] [MainThread]:   sslrootcert: None
[0m11:37:42.387601 [info ] [MainThread]:   application_name: dbt
[0m11:37:42.388944 [info ] [MainThread]:   retries: 1
[0m11:37:42.402731 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:37:42.486499 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:37:42.489231 [debug] [MainThread]: Using postgres connection "debug"
[0m11:37:42.490594 [debug] [MainThread]: On debug: select 1 as id
[0m11:37:42.497567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:52.550034 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "10.4.251.244", port 5432 failed: timeout expired

[0m11:37:52.553664 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m11:37:52.555023 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:37:52.556119 [debug] [MainThread]: On debug: No close available on handle
[0m11:37:52.557704 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:37:52.559103 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:37:52.560125 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "10.4.251.244", port 5432 failed: Host is down
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:37:52.569116 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 12.533807, "process_user_time": 5.86548, "process_kernel_time": 0.695418, "process_mem_max_rss": "92823552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:37:52.570378 [debug] [MainThread]: Command `dbt debug` failed at 11:37:52.570100 after 12.54 seconds
[0m11:37:52.571139 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:37:52.571822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e20260>]}
[0m11:37:52.572590 [debug] [MainThread]: Flushing usage events
[0m11:42:11.605174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a22f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a255b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2557f0>]}


============================== 11:42:11.617733 | c41c470a-88ef-4e25-bd44-206ca4589047 ==============================
[0m11:42:11.617733 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:42:11.619073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:42:11.619925 [info ] [MainThread]: dbt version: 1.7.11
[0m11:42:11.620465 [info ] [MainThread]: python version: 3.12.2
[0m11:42:11.620992 [info ] [MainThread]: python path: /Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt-env/bin/python3.12
[0m11:42:11.622062 [info ] [MainThread]: os info: macOS-12.7.3-x86_64-i386-64bit
[0m11:42:11.867284 [info ] [MainThread]: Using profiles dir at /Users/estelleclement/.dbt
[0m11:42:11.868096 [info ] [MainThread]: Using profiles.yml file at /Users/estelleclement/.dbt/profiles.yml
[0m11:42:11.868727 [info ] [MainThread]: Using dbt_project.yml file at /Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/dbt_project.yml
[0m11:42:11.870805 [info ] [MainThread]: adapter type: postgres
[0m11:42:11.871529 [info ] [MainThread]: adapter version: 1.7.11
[0m11:42:12.093465 [info ] [MainThread]: Configuration:
[0m11:42:12.094262 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:42:12.094993 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:42:12.095653 [info ] [MainThread]: Required dependencies:
[0m11:42:12.096480 [debug] [MainThread]: Executing "git --help"
[0m11:42:12.190987 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:42:12.192678 [debug] [MainThread]: STDERR: "b''"
[0m11:42:12.193313 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:42:12.193917 [info ] [MainThread]: Connection:
[0m11:42:12.194965 [info ] [MainThread]:   host: 10.4.253.65
[0m11:42:12.195821 [info ] [MainThread]:   port: 5432
[0m11:42:12.196365 [info ] [MainThread]:   user: postgres
[0m11:42:12.196885 [info ] [MainThread]:   database: postgres
[0m11:42:12.197484 [info ] [MainThread]:   schema: public
[0m11:42:12.198036 [info ] [MainThread]:   connect_timeout: 10
[0m11:42:12.198587 [info ] [MainThread]:   role: None
[0m11:42:12.199277 [info ] [MainThread]:   search_path: None
[0m11:42:12.200233 [info ] [MainThread]:   keepalives_idle: 0
[0m11:42:12.200975 [info ] [MainThread]:   sslmode: None
[0m11:42:12.201701 [info ] [MainThread]:   sslcert: None
[0m11:42:12.202324 [info ] [MainThread]:   sslkey: None
[0m11:42:12.202926 [info ] [MainThread]:   sslrootcert: None
[0m11:42:12.204021 [info ] [MainThread]:   application_name: dbt
[0m11:42:12.205100 [info ] [MainThread]:   retries: 1
[0m11:42:12.206537 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:42:12.220031 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:42:12.226102 [debug] [MainThread]: Using postgres connection "debug"
[0m11:42:12.227838 [debug] [MainThread]: On debug: select 1 as id
[0m11:42:12.229204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:12.605799 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:42:12.608421 [debug] [MainThread]: On debug: Close
[0m11:42:12.609150 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:42:12.609947 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:42:12.617494 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1129019, "process_user_time": 3.367727, "process_kernel_time": 0.625787, "process_mem_max_rss": "96464896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:42:12.618867 [debug] [MainThread]: Command `dbt debug` succeeded at 11:42:12.618518 after 1.12 seconds
[0m11:42:12.619675 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:42:12.620613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a202750>]}
[0m11:42:12.621424 [debug] [MainThread]: Flushing usage events
[0m11:43:46.904205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c71430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c95ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c95c70>]}


============================== 11:43:46.915430 | bdcd14c0-646e-44fd-b548-86b4057019b2 ==============================
[0m11:43:46.915430 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:43:46.916494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'debug': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:47.355996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdcd14c0-646e-44fd-b548-86b4057019b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a0320>]}
[0m11:43:47.532750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdcd14c0-646e-44fd-b548-86b4057019b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d527e0>]}
[0m11:43:47.536747 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:43:47.580438 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:43:47.581849 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:43:47.582618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdcd14c0-646e-44fd-b548-86b4057019b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26a9c0>]}
[0m11:43:49.136554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdcd14c0-646e-44fd-b548-86b4057019b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d89b0>]}
[0m11:43:49.149958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdcd14c0-646e-44fd-b548-86b4057019b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a98fa10>]}
[0m11:43:49.150901 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:43:49.151741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdcd14c0-646e-44fd-b548-86b4057019b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b0800>]}
[0m11:43:49.154064 [info ] [MainThread]: 
[0m11:43:49.154834 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:43:49.155721 [debug] [MainThread]: Command end result
[0m11:43:49.172528 [info ] [MainThread]: 
[0m11:43:49.173709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:49.174841 [info ] [MainThread]: 
[0m11:43:49.175813 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m11:43:49.180425 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.3799598, "process_user_time": 5.026485, "process_kernel_time": 0.575517, "process_mem_max_rss": "101687296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:43:49.181417 [debug] [MainThread]: Command `dbt seed` succeeded at 11:43:49.181193 after 2.38 seconds
[0m11:43:49.182232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c71430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a82f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4e030>]}
[0m11:43:49.183070 [debug] [MainThread]: Flushing usage events
[0m11:47:36.270488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f49700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f75d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f75af0>]}


============================== 11:47:36.281281 | 2dfc4bcf-30c1-45de-92b4-7ec6fe58357a ==============================
[0m11:47:36.281281 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:47:36.282375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_sales', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:47:36.642000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dfc4bcf-30c1-45de-92b4-7ec6fe58357a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c8aa20>]}
[0m11:47:36.766275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dfc4bcf-30c1-45de-92b4-7ec6fe58357a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11050c4a0>]}
[0m11:47:36.769057 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:47:36.803337 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:47:36.892634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m11:47:36.893459 [debug] [MainThread]: Partial parsing: added file: dbt_tp://seeds/raw_product_data.csv
[0m11:47:36.893998 [debug] [MainThread]: Partial parsing: added file: dbt_tp://seeds/raw_sales_data.csv
[0m11:47:36.894543 [debug] [MainThread]: Partial parsing: added file: dbt_tp://models/staging/stg_sales.sql
[0m11:47:37.218351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dfc4bcf-30c1-45de-92b4-7ec6fe58357a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c2efc0>]}
[0m11:47:37.234175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dfc4bcf-30c1-45de-92b4-7ec6fe58357a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a9fcb0>]}
[0m11:47:37.234903 [info ] [MainThread]: Found 3 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:47:37.235615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dfc4bcf-30c1-45de-92b4-7ec6fe58357a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d40f20>]}
[0m11:47:37.240410 [info ] [MainThread]: 
[0m11:47:37.241875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:47:37.244172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:47:37.262212 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:47:37.263244 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:47:37.264431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:37.367316 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:47:37.369470 [debug] [ThreadPool]: On list_postgres: Close
[0m11:47:37.372192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:47:37.380850 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:47:37.381489 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:47:37.381938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:37.407886 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:47:37.408836 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:47:37.409456 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:47:37.415467 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:47:37.417723 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:47:37.419492 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:47:37.429733 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:37.430699 [debug] [MainThread]: On master: BEGIN
[0m11:47:37.431217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:37.451106 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:47:37.451775 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:37.452605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:47:37.469019 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:47:37.473885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dfc4bcf-30c1-45de-92b4-7ec6fe58357a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11086e8d0>]}
[0m11:47:37.474550 [debug] [MainThread]: On master: ROLLBACK
[0m11:47:37.476048 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:37.476615 [debug] [MainThread]: On master: BEGIN
[0m11:47:37.478685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:47:37.479517 [debug] [MainThread]: On master: COMMIT
[0m11:47:37.480006 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:37.480721 [debug] [MainThread]: On master: COMMIT
[0m11:47:37.482232 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:47:37.482905 [debug] [MainThread]: On master: Close
[0m11:47:37.484562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:37.485521 [info ] [MainThread]: 
[0m11:47:37.492225 [debug] [Thread-1 (]: Began running node model.dbt_tp.stg_sales
[0m11:47:37.493543 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sales ................................... [RUN]
[0m11:47:37.495580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.stg_sales)
[0m11:47:37.496598 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.stg_sales
[0m11:47:37.512637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.stg_sales"
[0m11:47:37.515966 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (compile): 11:47:37.497030 => 11:47:37.515176
[0m11:47:37.516949 [debug] [Thread-1 (]: Began executing node model.dbt_tp.stg_sales
[0m11:47:37.603929 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.stg_sales"
[0m11:47:37.605795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:47:37.606816 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: BEGIN
[0m11:47:37.607592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:37.632440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:47:37.633162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:47:37.633778 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */

  create view "postgres"."public"."stg_sales__dbt_tmp"
    
    
  as (
    

select
    sale_id,
    product_id,
    quantity::integer as quantity,
    sale_date::date as sale_date
from "postgres"."public"."raw_sales_data"
  );
[0m11:47:37.659604 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:47:37.671898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:47:37.672865 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */
alter table "postgres"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m11:47:37.674673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:47:37.678902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:47:37.679512 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */
alter table "postgres"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:47:37.681221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:47:37.705483 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: COMMIT
[0m11:47:37.706252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:47:37.706812 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: COMMIT
[0m11:47:37.712508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:47:37.721658 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_sales__dbt_backup"
[0m11:47:37.729309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:47:37.729979 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */
drop view if exists "postgres"."public"."stg_sales__dbt_backup" cascade
[0m11:47:37.742595 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:47:37.745366 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (execute): 11:47:37.517840 => 11:47:37.745004
[0m11:47:37.745934 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: Close
[0m11:47:37.747172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dfc4bcf-30c1-45de-92b4-7ec6fe58357a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d9dfa0>]}
[0m11:47:37.749488 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.25s]
[0m11:47:37.750641 [debug] [Thread-1 (]: Finished running node model.dbt_tp.stg_sales
[0m11:47:37.754779 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:37.755535 [debug] [MainThread]: On master: BEGIN
[0m11:47:37.755984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:37.782841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:47:37.783528 [debug] [MainThread]: On master: COMMIT
[0m11:47:37.784007 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:37.784485 [debug] [MainThread]: On master: COMMIT
[0m11:47:37.785730 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:47:37.786430 [debug] [MainThread]: On master: Close
[0m11:47:37.787552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:37.788114 [debug] [MainThread]: Connection 'model.dbt_tp.stg_sales' was properly closed.
[0m11:47:37.789141 [info ] [MainThread]: 
[0m11:47:37.790128 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m11:47:37.792600 [debug] [MainThread]: Command end result
[0m11:47:37.802922 [info ] [MainThread]: 
[0m11:47:37.803717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:37.804307 [info ] [MainThread]: 
[0m11:47:37.804958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:47:37.812114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6287321, "process_user_time": 3.944476, "process_kernel_time": 0.566457, "process_mem_max_rss": "108494848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:47:37.813141 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:37.812913 after 1.63 seconds
[0m11:47:37.813821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f75af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c1bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd9be0>]}
[0m11:47:37.814547 [debug] [MainThread]: Flushing usage events
[0m11:49:12.383478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f086720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0b6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0b5d90>]}


============================== 11:49:12.394986 | 05cd3390-40a4-496a-9cbc-40251401bce3 ==============================
[0m11:49:12.394986 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:49:12.396460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_sales', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:49:12.725466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05cd3390-40a4-496a-9cbc-40251401bce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f137320>]}
[0m11:49:12.852842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05cd3390-40a4-496a-9cbc-40251401bce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0dc8c0>]}
[0m11:49:12.855133 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:49:12.894844 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:49:12.978649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:12.979514 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/staging/stg_sales.sql
[0m11:49:13.182223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05cd3390-40a4-496a-9cbc-40251401bce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f680560>]}
[0m11:49:13.197043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05cd3390-40a4-496a-9cbc-40251401bce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f780fe0>]}
[0m11:49:13.197988 [info ] [MainThread]: Found 3 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:49:13.198671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05cd3390-40a4-496a-9cbc-40251401bce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd743b0>]}
[0m11:49:13.203294 [info ] [MainThread]: 
[0m11:49:13.204737 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:49:13.207034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:49:13.228784 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:49:13.229381 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:49:13.229888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:13.343515 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:49:13.346312 [debug] [ThreadPool]: On list_postgres: Close
[0m11:49:13.350360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:49:13.359913 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:49:13.360492 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:49:13.361326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:49:13.382468 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:49:13.383094 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:49:13.383696 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:49:13.389384 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:49:13.391639 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:49:13.393179 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:49:13.403264 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:13.403873 [debug] [MainThread]: On master: BEGIN
[0m11:49:13.404370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:49:13.426538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:13.427573 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:13.428534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:49:13.438254 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:49:13.440770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05cd3390-40a4-496a-9cbc-40251401bce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0b6300>]}
[0m11:49:13.441577 [debug] [MainThread]: On master: ROLLBACK
[0m11:49:13.443458 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:13.444055 [debug] [MainThread]: On master: BEGIN
[0m11:49:13.447527 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:13.448307 [debug] [MainThread]: On master: COMMIT
[0m11:49:13.448828 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:13.449372 [debug] [MainThread]: On master: COMMIT
[0m11:49:13.450607 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:49:13.451164 [debug] [MainThread]: On master: Close
[0m11:49:13.452284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:49:13.452898 [info ] [MainThread]: 
[0m11:49:13.457187 [debug] [Thread-1 (]: Began running node model.dbt_tp.stg_sales
[0m11:49:13.457968 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sales ................................... [RUN]
[0m11:49:13.459180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.stg_sales)
[0m11:49:13.459909 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.stg_sales
[0m11:49:13.473816 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.stg_sales"
[0m11:49:13.474956 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (compile): 11:49:13.460351 => 11:49:13.474607
[0m11:49:13.475535 [debug] [Thread-1 (]: Began executing node model.dbt_tp.stg_sales
[0m11:49:13.537870 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.stg_sales"
[0m11:49:13.538939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:49:13.539515 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: BEGIN
[0m11:49:13.540133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:13.559824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:13.560563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:49:13.561221 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */

  create view "postgres"."public"."stg_sales__dbt_tmp"
    
    
  as (
    

select
    sale_id,
    product_id,
    quantity::integer as quantity,
    sale_date::date as sale_date
from "postgres"."public"."raw_sales_data"

select  * from stg_sales
  );
[0m11:49:13.564914 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16: select  * from stg_sales
         ^

[0m11:49:13.566117 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: ROLLBACK
[0m11:49:13.567949 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (execute): 11:49:13.475880 => 11:49:13.567477
[0m11:49:13.568644 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: Close
[0m11:49:13.585949 [debug] [Thread-1 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near "select"
  LINE 16: select  * from stg_sales
           ^
  compiled Code at target/run/dbt_tp/models/staging/stg_sales.sql
[0m11:49:13.586764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05cd3390-40a4-496a-9cbc-40251401bce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc83620>]}
[0m11:49:13.588844 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.13s]
[0m11:49:13.590455 [debug] [Thread-1 (]: Finished running node model.dbt_tp.stg_sales
[0m11:49:13.594439 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:13.595016 [debug] [MainThread]: On master: BEGIN
[0m11:49:13.595888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:49:13.622809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:13.623547 [debug] [MainThread]: On master: COMMIT
[0m11:49:13.624068 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:13.624601 [debug] [MainThread]: On master: COMMIT
[0m11:49:13.625807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:49:13.626379 [debug] [MainThread]: On master: Close
[0m11:49:13.627494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:13.628026 [debug] [MainThread]: Connection 'model.dbt_tp.stg_sales' was properly closed.
[0m11:49:13.628619 [info ] [MainThread]: 
[0m11:49:13.629651 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m11:49:13.631081 [debug] [MainThread]: Command end result
[0m11:49:13.643470 [info ] [MainThread]: 
[0m11:49:13.644350 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:49:13.644968 [info ] [MainThread]: 
[0m11:49:13.645578 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near "select"
  LINE 16: select  * from stg_sales
           ^
  compiled Code at target/run/dbt_tp/models/staging/stg_sales.sql
[0m11:49:13.646333 [info ] [MainThread]: 
[0m11:49:13.650896 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:49:13.657029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3775728, "process_user_time": 3.853428, "process_kernel_time": 0.582158, "process_mem_max_rss": "106999808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:49:13.658343 [debug] [MainThread]: Command `dbt run` failed at 11:49:13.658028 after 1.38 seconds
[0m11:49:13.658955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1b6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc83620>]}
[0m11:49:13.659613 [debug] [MainThread]: Flushing usage events
[0m11:55:32.988798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e555490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e582000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e581d90>]}


============================== 11:55:32.999925 | f28d6f82-f0cb-472c-9f70-def37662cc6d ==============================
[0m11:55:32.999925 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:55:33.001050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_sales', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:33.381987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f28d6f82-f0cb-472c-9f70-def37662cc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e636570>]}
[0m11:55:33.508916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f28d6f82-f0cb-472c-9f70-def37662cc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb48c80>]}
[0m11:55:33.511513 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:55:33.545278 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:55:33.634219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:33.635091 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/staging/stg_sales.sql
[0m11:55:33.835396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f28d6f82-f0cb-472c-9f70-def37662cc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb49040>]}
[0m11:55:33.852212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f28d6f82-f0cb-472c-9f70-def37662cc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec4cf50>]}
[0m11:55:33.852880 [info ] [MainThread]: Found 3 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:55:33.853684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28d6f82-f0cb-472c-9f70-def37662cc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f21cc20>]}
[0m11:55:33.857973 [info ] [MainThread]: 
[0m11:55:33.859692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:33.861485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:55:33.879612 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:55:33.880290 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:55:33.880861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:34.001587 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:55:34.003695 [debug] [ThreadPool]: On list_postgres: Close
[0m11:55:34.006911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:55:34.015303 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:55:34.015892 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:55:34.016413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:34.035374 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:34.035941 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:55:34.036687 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:55:34.041830 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:55:34.043717 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:55:34.045195 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:55:34.053645 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:34.054215 [debug] [MainThread]: On master: BEGIN
[0m11:55:34.054658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:34.073740 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:34.074436 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:34.075018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:34.081796 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:34.084268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28d6f82-f0cb-472c-9f70-def37662cc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e682690>]}
[0m11:55:34.084872 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:34.086423 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:34.086978 [debug] [MainThread]: On master: BEGIN
[0m11:55:34.089168 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:34.089807 [debug] [MainThread]: On master: COMMIT
[0m11:55:34.090330 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:34.090931 [debug] [MainThread]: On master: COMMIT
[0m11:55:34.092246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:34.092806 [debug] [MainThread]: On master: Close
[0m11:55:34.093982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:34.094609 [info ] [MainThread]: 
[0m11:55:34.098951 [debug] [Thread-1 (]: Began running node model.dbt_tp.stg_sales
[0m11:55:34.099715 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sales ................................... [RUN]
[0m11:55:34.100924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.stg_sales)
[0m11:55:34.101654 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.stg_sales
[0m11:55:34.118278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.stg_sales"
[0m11:55:34.121548 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (compile): 11:55:34.102356 => 11:55:34.120556
[0m11:55:34.122562 [debug] [Thread-1 (]: Began executing node model.dbt_tp.stg_sales
[0m11:55:34.180454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.stg_sales"
[0m11:55:34.181566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:55:34.182217 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: BEGIN
[0m11:55:34.182775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:34.203279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:34.203937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m11:55:34.204500 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */

  create view "postgres"."public"."stg_sales__dbt_tmp"
    
    
  as (
    

select
    sale_id,
    product_id,
    quantity::integer as quantity,
    sale_date::date as sale_date
from "postgres"."public"."raw_sales_data"

select * from stg_sales
  );
[0m11:55:34.208010 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16: select * from stg_sales
         ^

[0m11:55:34.208668 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: ROLLBACK
[0m11:55:34.210263 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (execute): 11:55:34.123126 => 11:55:34.209869
[0m11:55:34.210848 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: Close
[0m11:55:34.225708 [debug] [Thread-1 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near "select"
  LINE 16: select * from stg_sales
           ^
  compiled Code at target/run/dbt_tp/models/staging/stg_sales.sql
[0m11:55:34.226428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f28d6f82-f0cb-472c-9f70-def37662cc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2cf560>]}
[0m11:55:34.228449 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.13s]
[0m11:55:34.229860 [debug] [Thread-1 (]: Finished running node model.dbt_tp.stg_sales
[0m11:55:34.232970 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:34.233571 [debug] [MainThread]: On master: BEGIN
[0m11:55:34.234016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:34.263759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:34.264427 [debug] [MainThread]: On master: COMMIT
[0m11:55:34.265332 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:34.266678 [debug] [MainThread]: On master: COMMIT
[0m11:55:34.270246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:34.271225 [debug] [MainThread]: On master: Close
[0m11:55:34.272420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:34.272977 [debug] [MainThread]: Connection 'model.dbt_tp.stg_sales' was properly closed.
[0m11:55:34.273562 [info ] [MainThread]: 
[0m11:55:34.274409 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m11:55:34.275579 [debug] [MainThread]: Command end result
[0m11:55:34.288278 [info ] [MainThread]: 
[0m11:55:34.289031 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:34.289559 [info ] [MainThread]: 
[0m11:55:34.290143 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near "select"
  LINE 16: select * from stg_sales
           ^
  compiled Code at target/run/dbt_tp/models/staging/stg_sales.sql
[0m11:55:34.290713 [info ] [MainThread]: 
[0m11:55:34.291305 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:34.295245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4064535, "process_user_time": 3.932131, "process_kernel_time": 0.643847, "process_mem_max_rss": "106811392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:34.297089 [debug] [MainThread]: Command `dbt run` failed at 11:55:34.296811 after 1.41 seconds
[0m11:55:34.298997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e072b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3bf3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ef9e0>]}
[0m11:55:34.300252 [debug] [MainThread]: Flushing usage events
[0m12:22:34.305434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e1d90>]}


============================== 12:22:34.318209 | 667ff1d8-76d1-433a-9009-5fecb6b9829c ==============================
[0m12:22:34.318209 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:22:34.319619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_sales', 'send_anonymous_usage_stats': 'True'}
[0m12:22:34.710405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '667ff1d8-76d1-433a-9009-5fecb6b9829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d061b0>]}
[0m12:22:34.850888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '667ff1d8-76d1-433a-9009-5fecb6b9829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b0770>]}
[0m12:22:34.853204 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:22:34.902228 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:22:34.943623 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:22:34.944863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '667ff1d8-76d1-433a-9009-5fecb6b9829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc5ac0>]}
[0m12:22:36.576956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '667ff1d8-76d1-433a-9009-5fecb6b9829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff3bf0>]}
[0m12:22:36.594919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '667ff1d8-76d1-433a-9009-5fecb6b9829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785ec00>]}
[0m12:22:36.595598 [info ] [MainThread]: Found 3 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:22:36.596273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '667ff1d8-76d1-433a-9009-5fecb6b9829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108043170>]}
[0m12:22:36.598994 [info ] [MainThread]: 
[0m12:22:36.604482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:22:36.608892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:22:36.645112 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:22:36.645847 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:22:36.646566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:36.783065 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:22:36.786958 [debug] [ThreadPool]: On list_postgres: Close
[0m12:22:36.790268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:22:36.802255 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:22:36.803280 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:22:36.803813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:36.832164 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:36.833211 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:22:36.833879 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:22:36.843787 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:22:36.845739 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:22:36.847913 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:22:36.861687 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:36.862345 [debug] [MainThread]: On master: BEGIN
[0m12:22:36.863089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:36.891633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:36.892285 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:36.892857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:22:36.997955 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:22:37.005224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '667ff1d8-76d1-433a-9009-5fecb6b9829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108064ef0>]}
[0m12:22:37.006337 [debug] [MainThread]: On master: ROLLBACK
[0m12:22:37.009415 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:37.010042 [debug] [MainThread]: On master: BEGIN
[0m12:22:37.012285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:37.012906 [debug] [MainThread]: On master: COMMIT
[0m12:22:37.013546 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:37.014303 [debug] [MainThread]: On master: COMMIT
[0m12:22:37.017579 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:22:37.018310 [debug] [MainThread]: On master: Close
[0m12:22:37.022599 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:37.024936 [info ] [MainThread]: 
[0m12:22:37.031256 [debug] [Thread-1 (]: Began running node model.dbt_tp.stg_sales
[0m12:22:37.032286 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sales ................................... [RUN]
[0m12:22:37.035453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.stg_sales)
[0m12:22:37.036451 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.stg_sales
[0m12:22:37.054558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.stg_sales"
[0m12:22:37.058257 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (compile): 12:22:37.036953 => 12:22:37.057807
[0m12:22:37.059061 [debug] [Thread-1 (]: Began executing node model.dbt_tp.stg_sales
[0m12:22:37.157307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.stg_sales"
[0m12:22:37.158877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m12:22:37.159657 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: BEGIN
[0m12:22:37.160289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:37.187972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:22:37.189526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m12:22:37.190254 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */

  create view "postgres"."public"."stg_sales__dbt_tmp"
    
    
  as (
    

select
    sale_id,
    product_id,
    quantity::integer as quantity,
    sale_date::date as sale_date
from "postgres"."public"."raw_sales_data"

select * from stg_sales
  );
[0m12:22:37.194037 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16: select * from stg_sales
         ^

[0m12:22:37.194991 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: ROLLBACK
[0m12:22:37.196935 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (execute): 12:22:37.059601 => 12:22:37.196534
[0m12:22:37.197622 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: Close
[0m12:22:37.213865 [debug] [Thread-1 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near "select"
  LINE 16: select * from stg_sales
           ^
  compiled Code at target/run/dbt_tp/models/staging/stg_sales.sql
[0m12:22:37.215042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667ff1d8-76d1-433a-9009-5fecb6b9829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108035460>]}
[0m12:22:37.217597 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.18s]
[0m12:22:37.219382 [debug] [Thread-1 (]: Finished running node model.dbt_tp.stg_sales
[0m12:22:37.223204 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:37.223800 [debug] [MainThread]: On master: BEGIN
[0m12:22:37.224252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:37.247728 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:37.248534 [debug] [MainThread]: On master: COMMIT
[0m12:22:37.249117 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:37.249956 [debug] [MainThread]: On master: COMMIT
[0m12:22:37.255036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:22:37.256106 [debug] [MainThread]: On master: Close
[0m12:22:37.257528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:37.258179 [debug] [MainThread]: Connection 'model.dbt_tp.stg_sales' was properly closed.
[0m12:22:37.258756 [info ] [MainThread]: 
[0m12:22:37.259714 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m12:22:37.260741 [debug] [MainThread]: Command end result
[0m12:22:37.273261 [info ] [MainThread]: 
[0m12:22:37.273922 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:22:37.274613 [info ] [MainThread]: 
[0m12:22:37.275388 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near "select"
  LINE 16: select * from stg_sales
           ^
  compiled Code at target/run/dbt_tp/models/staging/stg_sales.sql
[0m12:22:37.275939 [info ] [MainThread]: 
[0m12:22:37.276500 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:22:37.281546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0862756, "process_user_time": 5.344542, "process_kernel_time": 0.755114, "process_mem_max_rss": "110194688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:22:37.282885 [debug] [MainThread]: Command `dbt run` failed at 12:22:37.282431 after 3.09 seconds
[0m12:22:37.284182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f982f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bff860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3bd40>]}
[0m12:22:37.285180 [debug] [MainThread]: Flushing usage events
[0m12:25:06.345032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085da030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d9d90>]}


============================== 12:25:06.355602 | 9a7633fa-8506-4b96-83b3-3dd17e89261c ==============================
[0m12:25:06.355602 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:25:06.356558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'version_check': 'True', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_sales', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:06.837558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a7633fa-8506-4b96-83b3-3dd17e89261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108671af0>]}
[0m12:25:06.964266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a7633fa-8506-4b96-83b3-3dd17e89261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108582210>]}
[0m12:25:06.966646 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:25:07.006674 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:25:07.090441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:25:07.091312 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/staging/stg_sales.sql
[0m12:25:07.291208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a7633fa-8506-4b96-83b3-3dd17e89261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba18e0>]}
[0m12:25:07.305074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a7633fa-8506-4b96-83b3-3dd17e89261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca4350>]}
[0m12:25:07.305754 [info ] [MainThread]: Found 3 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:25:07.306612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a7633fa-8506-4b96-83b3-3dd17e89261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868efc0>]}
[0m12:25:07.311126 [info ] [MainThread]: 
[0m12:25:07.312802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:25:07.315113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:25:07.338064 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:25:07.338742 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:25:07.340179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:07.435209 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:25:07.437226 [debug] [ThreadPool]: On list_postgres: Close
[0m12:25:07.440016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:25:07.448102 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:25:07.448728 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:25:07.449188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:07.469196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:25:07.469825 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:25:07.470340 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:25:07.474706 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:25:07.476813 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:25:07.478334 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:25:07.486688 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:07.487314 [debug] [MainThread]: On master: BEGIN
[0m12:25:07.487789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:07.505757 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:25:07.506417 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:07.507021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:25:07.513677 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:25:07.516259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a7633fa-8506-4b96-83b3-3dd17e89261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebc0b0>]}
[0m12:25:07.516905 [debug] [MainThread]: On master: ROLLBACK
[0m12:25:07.518125 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:07.518748 [debug] [MainThread]: On master: BEGIN
[0m12:25:07.520580 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:25:07.521201 [debug] [MainThread]: On master: COMMIT
[0m12:25:07.521872 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:07.522352 [debug] [MainThread]: On master: COMMIT
[0m12:25:07.523775 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:25:07.524554 [debug] [MainThread]: On master: Close
[0m12:25:07.525790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:07.526424 [info ] [MainThread]: 
[0m12:25:07.530523 [debug] [Thread-1 (]: Began running node model.dbt_tp.stg_sales
[0m12:25:07.531361 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sales ................................... [RUN]
[0m12:25:07.532674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.stg_sales)
[0m12:25:07.533681 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.stg_sales
[0m12:25:07.546259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.stg_sales"
[0m12:25:07.547388 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (compile): 12:25:07.534315 => 12:25:07.547038
[0m12:25:07.548156 [debug] [Thread-1 (]: Began executing node model.dbt_tp.stg_sales
[0m12:25:07.606238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.stg_sales"
[0m12:25:07.607512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m12:25:07.608189 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: BEGIN
[0m12:25:07.608746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:07.627821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:25:07.628564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m12:25:07.629110 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */

  create view "postgres"."public"."stg_sales__dbt_tmp"
    
    
  as (
    

select
    sale_id,
    product_id,
    quantity::integer as quantity,
    sale_date::date as sale_date
from "postgres"."public"."raw_sales_data"
  );
[0m12:25:07.645713 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:25:07.654876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m12:25:07.655790 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */
alter table "postgres"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m12:25:07.657433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:25:07.661471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m12:25:07.662072 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */
alter table "postgres"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m12:25:07.663954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:25:07.687277 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: COMMIT
[0m12:25:07.687927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m12:25:07.688470 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: COMMIT
[0m12:25:07.691827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:25:07.700272 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_sales__dbt_backup"
[0m12:25:07.707728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_sales"
[0m12:25:07.708353 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_sales"} */
drop view if exists "postgres"."public"."stg_sales__dbt_backup" cascade
[0m12:25:07.716881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:25:07.719630 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_sales (execute): 12:25:07.548926 => 12:25:07.719289
[0m12:25:07.720211 [debug] [Thread-1 (]: On model.dbt_tp.stg_sales: Close
[0m12:25:07.721478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a7633fa-8506-4b96-83b3-3dd17e89261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930e2a0>]}
[0m12:25:07.722456 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.19s]
[0m12:25:07.724007 [debug] [Thread-1 (]: Finished running node model.dbt_tp.stg_sales
[0m12:25:07.726129 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:07.726687 [debug] [MainThread]: On master: BEGIN
[0m12:25:07.727133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:07.770902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:25:07.772330 [debug] [MainThread]: On master: COMMIT
[0m12:25:07.773279 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:07.774147 [debug] [MainThread]: On master: COMMIT
[0m12:25:07.778954 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:25:07.779961 [debug] [MainThread]: On master: Close
[0m12:25:07.781970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:07.782960 [debug] [MainThread]: Connection 'model.dbt_tp.stg_sales' was properly closed.
[0m12:25:07.784065 [info ] [MainThread]: 
[0m12:25:07.785775 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m12:25:07.787665 [debug] [MainThread]: Command end result
[0m12:25:07.813709 [info ] [MainThread]: 
[0m12:25:07.815038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:07.816453 [info ] [MainThread]: 
[0m12:25:07.817545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:25:07.830890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6521597, "process_user_time": 4.127345, "process_kernel_time": 0.593391, "process_mem_max_rss": "106266624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:25:07.832124 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:07.831764 after 1.65 seconds
[0m12:25:07.833125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085da030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d9f70>]}
[0m12:25:07.833994 [debug] [MainThread]: Flushing usage events
[0m12:28:04.130335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ceeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d19df0>]}


============================== 12:28:04.141492 | d0a6595d-6728-462a-83f2-17114a22d494 ==============================
[0m12:28:04.141492 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:28:04.142566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'profiles_dir': '/Users/estelleclement/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_products', 'send_anonymous_usage_stats': 'True'}
[0m12:28:04.478897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0a6595d-6728-462a-83f2-17114a22d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8cce0>]}
[0m12:28:04.601375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0a6595d-6728-462a-83f2-17114a22d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1a420>]}
[0m12:28:04.603882 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:28:04.637506 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:28:04.728361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:28:04.729142 [debug] [MainThread]: Partial parsing: added file: dbt_tp://models/staging/stg_products.sql
[0m12:28:04.729768 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/staging/stg_sales.sql
[0m12:28:04.932593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0a6595d-6728-462a-83f2-17114a22d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a06d20>]}
[0m12:28:04.948350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0a6595d-6728-462a-83f2-17114a22d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888c110>]}
[0m12:28:04.949065 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:28:04.949703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0a6595d-6728-462a-83f2-17114a22d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070435c0>]}
[0m12:28:04.955923 [info ] [MainThread]: 
[0m12:28:04.958764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:04.966433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:28:04.990184 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:28:04.990810 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:28:04.991528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:05.106773 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:28:05.108933 [debug] [ThreadPool]: On list_postgres: Close
[0m12:28:05.112076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:28:05.119938 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:28:05.120503 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:28:05.120980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:05.140479 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:28:05.141105 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:28:05.141670 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:28:05.146327 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:28:05.148190 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:28:05.149699 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:28:05.158228 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:05.159122 [debug] [MainThread]: On master: BEGIN
[0m12:28:05.159730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:05.178312 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:05.179074 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:05.179669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:05.186871 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:28:05.189286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0a6595d-6728-462a-83f2-17114a22d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108981d30>]}
[0m12:28:05.189911 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:05.191287 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:05.191948 [debug] [MainThread]: On master: BEGIN
[0m12:28:05.194003 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:05.194726 [debug] [MainThread]: On master: COMMIT
[0m12:28:05.195246 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:05.195777 [debug] [MainThread]: On master: COMMIT
[0m12:28:05.197074 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:05.197685 [debug] [MainThread]: On master: Close
[0m12:28:05.198874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:05.199839 [info ] [MainThread]: 
[0m12:28:05.203704 [debug] [Thread-1 (]: Began running node model.dbt_tp.stg_products
[0m12:28:05.204480 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m12:28:05.205718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.stg_products)
[0m12:28:05.206899 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.stg_products
[0m12:28:05.221861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.stg_products"
[0m12:28:05.223088 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_products (compile): 12:28:05.207590 => 12:28:05.222688
[0m12:28:05.223731 [debug] [Thread-1 (]: Began executing node model.dbt_tp.stg_products
[0m12:28:05.286445 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.stg_products"
[0m12:28:05.287594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_products"
[0m12:28:05.288256 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: BEGIN
[0m12:28:05.288810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:05.308929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:05.309681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_products"
[0m12:28:05.310249 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_products"} */

  create view "postgres"."public"."stg_products__dbt_tmp"
    
    
  as (
    

select
    product_id,
    product_name::varchar(255) as product_name,
    category::varchar(50) as category,
    price::numeric(10, 2) as price
from "postgres"."public"."raw_product_data"

select * from stg_sales
  );
[0m12:28:05.313611 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16: select * from stg_sales
         ^

[0m12:28:05.314342 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: ROLLBACK
[0m12:28:05.316006 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_products (execute): 12:28:05.224631 => 12:28:05.315621
[0m12:28:05.316830 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: Close
[0m12:28:05.333760 [debug] [Thread-1 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near "select"
  LINE 16: select * from stg_sales
           ^
  compiled Code at target/run/dbt_tp/models/staging/stg_products.sql
[0m12:28:05.334720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0a6595d-6728-462a-83f2-17114a22d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7b200>]}
[0m12:28:05.336975 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.13s]
[0m12:28:05.338838 [debug] [Thread-1 (]: Finished running node model.dbt_tp.stg_products
[0m12:28:05.342430 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:05.342984 [debug] [MainThread]: On master: BEGIN
[0m12:28:05.343461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:05.373269 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:05.374498 [debug] [MainThread]: On master: COMMIT
[0m12:28:05.375134 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:05.375767 [debug] [MainThread]: On master: COMMIT
[0m12:28:05.377087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:05.377648 [debug] [MainThread]: On master: Close
[0m12:28:05.378742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:05.379284 [debug] [MainThread]: Connection 'model.dbt_tp.stg_products' was properly closed.
[0m12:28:05.379805 [info ] [MainThread]: 
[0m12:28:05.380547 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m12:28:05.381983 [debug] [MainThread]: Command end result
[0m12:28:05.394298 [info ] [MainThread]: 
[0m12:28:05.395206 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:28:05.395774 [info ] [MainThread]: 
[0m12:28:05.396315 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near "select"
  LINE 16: select * from stg_sales
           ^
  compiled Code at target/run/dbt_tp/models/staging/stg_products.sql
[0m12:28:05.396932 [info ] [MainThread]: 
[0m12:28:05.397613 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:28:05.405429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3746295, "process_user_time": 3.886786, "process_kernel_time": 0.615534, "process_mem_max_rss": "106856448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:05.406452 [debug] [MainThread]: Command `dbt run` failed at 12:28:05.406237 after 1.38 seconds
[0m12:28:05.407065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107130fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5f680>]}
[0m12:28:05.407633 [debug] [MainThread]: Flushing usage events
[0m12:28:18.477204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d45df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d72090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71d00>]}


============================== 12:28:18.487522 | 872834a6-f3fd-4d3d-a49e-4daabae957fd ==============================
[0m12:28:18.487522 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:28:18.488469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_products', 'send_anonymous_usage_stats': 'True'}
[0m12:28:18.838045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '872834a6-f3fd-4d3d-a49e-4daabae957fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c31d00>]}
[0m12:28:18.975623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '872834a6-f3fd-4d3d-a49e-4daabae957fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11324c830>]}
[0m12:28:18.977984 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:28:19.012448 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:28:19.099129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:19.100007 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/staging/stg_products.sql
[0m12:28:19.302813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '872834a6-f3fd-4d3d-a49e-4daabae957fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142d8da0>]}
[0m12:28:19.316677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '872834a6-f3fd-4d3d-a49e-4daabae957fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114444170>]}
[0m12:28:19.317393 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:28:19.318031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '872834a6-f3fd-4d3d-a49e-4daabae957fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a37620>]}
[0m12:28:19.322407 [info ] [MainThread]: 
[0m12:28:19.323726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:19.325963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:28:19.350342 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:28:19.351337 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:28:19.352564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:19.448973 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:28:19.451156 [debug] [ThreadPool]: On list_postgres: Close
[0m12:28:19.455112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:28:19.463172 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:28:19.463748 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:28:19.464486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:19.492257 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:28:19.493371 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:28:19.494515 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:28:19.500410 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:28:19.502616 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:28:19.506616 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:28:19.523241 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.523849 [debug] [MainThread]: On master: BEGIN
[0m12:28:19.524513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:19.542532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:19.543332 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.544021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:19.550638 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:28:19.553559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '872834a6-f3fd-4d3d-a49e-4daabae957fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114312990>]}
[0m12:28:19.554230 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:19.555553 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.556215 [debug] [MainThread]: On master: BEGIN
[0m12:28:19.558165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:19.558769 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.559391 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.559846 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.561055 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:19.561606 [debug] [MainThread]: On master: Close
[0m12:28:19.563215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:19.564498 [info ] [MainThread]: 
[0m12:28:19.568553 [debug] [Thread-1 (]: Began running node model.dbt_tp.stg_products
[0m12:28:19.569530 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m12:28:19.571000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.stg_products)
[0m12:28:19.571737 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.stg_products
[0m12:28:19.586563 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.stg_products"
[0m12:28:19.588533 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_products (compile): 12:28:19.572201 => 12:28:19.588075
[0m12:28:19.589705 [debug] [Thread-1 (]: Began executing node model.dbt_tp.stg_products
[0m12:28:19.650369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.stg_products"
[0m12:28:19.652215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_products"
[0m12:28:19.652868 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: BEGIN
[0m12:28:19.653372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:19.673020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:19.673831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_products"
[0m12:28:19.674650 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_products"} */

  create view "postgres"."public"."stg_products__dbt_tmp"
    
    
  as (
    

select
    product_id,
    product_name::varchar(255) as product_name,
    category::varchar(50) as category,
    price::numeric(10, 2) as price
from "postgres"."public"."raw_product_data"
  );
[0m12:28:19.681886 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:19.691091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_products"
[0m12:28:19.691764 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_products"} */
alter table "postgres"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m12:28:19.693704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:19.698692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_products"
[0m12:28:19.700009 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_products"} */
alter table "postgres"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:28:19.702273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:19.725449 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: COMMIT
[0m12:28:19.726183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_products"
[0m12:28:19.726715 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: COMMIT
[0m12:28:19.730457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:19.738812 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_products__dbt_backup"
[0m12:28:19.747230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.stg_products"
[0m12:28:19.747877 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.stg_products"} */
drop view if exists "postgres"."public"."stg_products__dbt_backup" cascade
[0m12:28:19.752551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:19.754889 [debug] [Thread-1 (]: Timing info for model.dbt_tp.stg_products (execute): 12:28:19.590128 => 12:28:19.754519
[0m12:28:19.755484 [debug] [Thread-1 (]: On model.dbt_tp.stg_products: Close
[0m12:28:19.756750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '872834a6-f3fd-4d3d-a49e-4daabae957fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ae86b0>]}
[0m12:28:19.757724 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:28:19.759010 [debug] [Thread-1 (]: Finished running node model.dbt_tp.stg_products
[0m12:28:19.761155 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.761712 [debug] [MainThread]: On master: BEGIN
[0m12:28:19.762156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:19.793518 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:19.794457 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.795313 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.795948 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.797580 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:19.798472 [debug] [MainThread]: On master: Close
[0m12:28:19.799590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:19.800184 [debug] [MainThread]: Connection 'model.dbt_tp.stg_products' was properly closed.
[0m12:28:19.800721 [info ] [MainThread]: 
[0m12:28:19.802039 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m12:28:19.803722 [debug] [MainThread]: Command end result
[0m12:28:19.821896 [info ] [MainThread]: 
[0m12:28:19.823047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:19.824125 [info ] [MainThread]: 
[0m12:28:19.825225 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:19.831689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4451498, "process_user_time": 3.855152, "process_kernel_time": 0.516918, "process_mem_max_rss": "107094016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:19.832995 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:19.832764 after 1.45 seconds
[0m12:28:19.833635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b805c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ac1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112032f30>]}
[0m12:28:19.834806 [debug] [MainThread]: Flushing usage events
[0m12:32:01.659775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f9f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc1d60>]}


============================== 12:32:01.670952 | 13d4a01a-5b27-4a67-8e0d-96dcd2a737bb ==============================
[0m12:32:01.670952 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:32:01.672506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_sales', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:32:02.037784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13d4a01a-5b27-4a67-8e0d-96dcd2a737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc1c40>]}
[0m12:32:02.161880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13d4a01a-5b27-4a67-8e0d-96dcd2a737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c9ee0>]}
[0m12:32:02.164272 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:32:02.196565 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:32:02.291372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:32:02.292260 [debug] [MainThread]: Partial parsing: added file: dbt_tp://models/staging/models.yml
[0m12:32:02.292928 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/staging/stg_products.sql
[0m12:32:02.685388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13d4a01a-5b27-4a67-8e0d-96dcd2a737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e8bfb0>]}
[0m12:32:02.702979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13d4a01a-5b27-4a67-8e0d-96dcd2a737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae8230>]}
[0m12:32:02.703893 [info ] [MainThread]: Found 4 models, 2 seeds, 6 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:32:02.704557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d4a01a-5b27-4a67-8e0d-96dcd2a737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d0e540>]}
[0m12:32:02.706934 [info ] [MainThread]: 
[0m12:32:02.708613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:32:02.711100 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m12:32:02.731111 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:32:02.731918 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:32:02.732436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:02.857741 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:32:02.858338 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:32:02.859398 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:32:02.864065 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:32:02.866655 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:32:02.867906 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:32:02.876656 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:02.877236 [debug] [MainThread]: On master: BEGIN
[0m12:32:02.877813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:02.896268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:32:02.896917 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:02.897524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:32:02.904161 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:32:02.908266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d4a01a-5b27-4a67-8e0d-96dcd2a737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c2e390>]}
[0m12:32:02.908922 [debug] [MainThread]: On master: ROLLBACK
[0m12:32:02.910201 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:02.910778 [debug] [MainThread]: On master: BEGIN
[0m12:32:02.912830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:32:02.913425 [debug] [MainThread]: On master: COMMIT
[0m12:32:02.914075 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:02.914684 [debug] [MainThread]: On master: COMMIT
[0m12:32:02.916035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:32:02.916672 [debug] [MainThread]: On master: Close
[0m12:32:02.917951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:02.918756 [info ] [MainThread]: 
[0m12:32:02.922721 [debug] [Thread-1 (]: Began running node test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929
[0m12:32:02.923424 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_sales_sale_id ................................... [RUN]
[0m12:32:02.924782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929)
[0m12:32:02.925796 [debug] [Thread-1 (]: Began compiling node test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929
[0m12:32:02.956473 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929"
[0m12:32:02.959127 [debug] [Thread-1 (]: Timing info for test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929 (compile): 12:32:02.926455 => 12:32:02.958158
[0m12:32:02.960117 [debug] [Thread-1 (]: Began executing node test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929
[0m12:32:02.984562 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929"
[0m12:32:02.985875 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929"
[0m12:32:02.986885 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929: BEGIN
[0m12:32:02.987548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:03.008222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:32:03.009028 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929"
[0m12:32:03.009650 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_id
from "postgres"."public"."stg_sales"
where sale_id is null



      
    ) dbt_internal_test
[0m12:32:03.019652 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:32:03.022919 [debug] [Thread-1 (]: Timing info for test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929 (execute): 12:32:02.960677 => 12:32:03.022511
[0m12:32:03.023736 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929: ROLLBACK
[0m12:32:03.025168 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929: Close
[0m12:32:03.027906 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_sales_sale_id ......................................... [[32mPASS[0m in 0.10s]
[0m12:32:03.029059 [debug] [Thread-1 (]: Finished running node test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929
[0m12:32:03.029737 [debug] [Thread-1 (]: Began running node test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521
[0m12:32:03.030425 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_sales_sale_id ..................................... [RUN]
[0m12:32:03.031408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_tp.not_null_stg_sales_sale_id.6b07c53929, now test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521)
[0m12:32:03.032098 [debug] [Thread-1 (]: Began compiling node test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521
[0m12:32:03.042263 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521"
[0m12:32:03.043475 [debug] [Thread-1 (]: Timing info for test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521 (compile): 12:32:03.032472 => 12:32:03.043091
[0m12:32:03.044415 [debug] [Thread-1 (]: Began executing node test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521
[0m12:32:03.048322 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521"
[0m12:32:03.050173 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521"
[0m12:32:03.051706 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521: BEGIN
[0m12:32:03.053467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:03.083551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:32:03.084256 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521"
[0m12:32:03.084870 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sale_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_sales"
where sale_id is not null
group by sale_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:32:03.087435 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:32:03.090085 [debug] [Thread-1 (]: Timing info for test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521 (execute): 12:32:03.045147 => 12:32:03.089472
[0m12:32:03.091054 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521: ROLLBACK
[0m12:32:03.094187 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521: Close
[0m12:32:03.095749 [info ] [Thread-1 (]: 2 of 2 PASS unique_stg_sales_sale_id ........................................... [[32mPASS[0m in 0.06s]
[0m12:32:03.096765 [debug] [Thread-1 (]: Finished running node test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521
[0m12:32:03.100465 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:03.101032 [debug] [MainThread]: On master: BEGIN
[0m12:32:03.101479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:32:03.133791 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:32:03.134415 [debug] [MainThread]: On master: COMMIT
[0m12:32:03.135082 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:03.135552 [debug] [MainThread]: On master: COMMIT
[0m12:32:03.136905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:32:03.137523 [debug] [MainThread]: On master: Close
[0m12:32:03.138933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:03.139492 [debug] [MainThread]: Connection 'test.dbt_tp.unique_stg_sales_sale_id.8a4f7c9521' was properly closed.
[0m12:32:03.146671 [info ] [MainThread]: 
[0m12:32:03.147898 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:32:03.149578 [debug] [MainThread]: Command end result
[0m12:32:03.162982 [info ] [MainThread]: 
[0m12:32:03.164247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:03.164971 [info ] [MainThread]: 
[0m12:32:03.170266 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:32:03.174010 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6035672, "process_user_time": 4.131716, "process_kernel_time": 0.618525, "process_mem_max_rss": "108617728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:32:03.175155 [debug] [MainThread]: Command `dbt test` succeeded at 12:32:03.174903 after 1.60 seconds
[0m12:32:03.177320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110330920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115cb140>]}
[0m12:32:03.178122 [debug] [MainThread]: Flushing usage events
[0m12:33:42.750587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164dc70>]}


============================== 12:33:42.762057 | cb058613-b221-489a-b213-57aaa35b3401 ==============================
[0m12:33:42.762057 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:33:42.763113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'debug': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_products', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:33:43.127301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb058613-b221-489a-b213-57aaa35b3401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11174dc70>]}
[0m12:33:43.251033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb058613-b221-489a-b213-57aaa35b3401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11106fad0>]}
[0m12:33:43.253387 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:33:43.290130 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:33:43.394120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:33:43.395057 [debug] [MainThread]: Partial parsing: added file: dbt_tp://models/staging/models2.yml
[0m12:33:43.728691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb058613-b221-489a-b213-57aaa35b3401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11239d400>]}
[0m12:33:43.744185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb058613-b221-489a-b213-57aaa35b3401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb8e30>]}
[0m12:33:43.744862 [info ] [MainThread]: Found 4 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:33:43.745492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb058613-b221-489a-b213-57aaa35b3401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122a68a0>]}
[0m12:33:43.747676 [info ] [MainThread]: 
[0m12:33:43.748988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:33:43.752156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m12:33:43.771849 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:33:43.772466 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:33:43.773010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:43.875780 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:33:43.876459 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:33:43.877014 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:33:43.881699 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:33:43.883875 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:33:43.885220 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:33:43.893476 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:43.894112 [debug] [MainThread]: On master: BEGIN
[0m12:33:43.894583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:43.915723 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:33:43.916352 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:43.917124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:33:43.923864 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:33:43.926709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb058613-b221-489a-b213-57aaa35b3401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111408b30>]}
[0m12:33:43.927394 [debug] [MainThread]: On master: ROLLBACK
[0m12:33:43.928806 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:43.929391 [debug] [MainThread]: On master: BEGIN
[0m12:33:43.931730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:33:43.932329 [debug] [MainThread]: On master: COMMIT
[0m12:33:43.932830 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:43.933287 [debug] [MainThread]: On master: COMMIT
[0m12:33:43.934645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:33:43.935206 [debug] [MainThread]: On master: Close
[0m12:33:43.936481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:43.937186 [info ] [MainThread]: 
[0m12:33:43.941300 [debug] [Thread-1 (]: Began running node test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec
[0m12:33:43.942388 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_products_products_id ............................ [RUN]
[0m12:33:43.943764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec)
[0m12:33:43.944806 [debug] [Thread-1 (]: Began compiling node test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec
[0m12:33:43.977644 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec"
[0m12:33:43.979833 [debug] [Thread-1 (]: Timing info for test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec (compile): 12:33:43.945199 => 12:33:43.979378
[0m12:33:43.980467 [debug] [Thread-1 (]: Began executing node test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec
[0m12:33:44.005249 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec"
[0m12:33:44.006426 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec"
[0m12:33:44.007059 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec: BEGIN
[0m12:33:44.007576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:44.027725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:44.028394 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec"
[0m12:33:44.029194 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select products_id
from "postgres"."public"."stg_products"
where products_id is null



      
    ) dbt_internal_test
[0m12:33:44.034480 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "products_id" does not exist
LINE 13: select products_id
                ^
HINT:  Perhaps you meant to reference the column "stg_products.product_id".

[0m12:33:44.035118 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec: ROLLBACK
[0m12:33:44.036792 [debug] [Thread-1 (]: Timing info for test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec (execute): 12:33:43.980847 => 12:33:44.036395
[0m12:33:44.037388 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec: Close
[0m12:33:44.050562 [debug] [Thread-1 (]: Database Error in test not_null_stg_products_products_id (models/staging/models2.yml)
  column "products_id" does not exist
  LINE 13: select products_id
                  ^
  HINT:  Perhaps you meant to reference the column "stg_products.product_id".
  compiled Code at target/run/dbt_tp/models/staging/models2.yml/not_null_stg_products_products_id.sql
[0m12:33:44.051600 [error] [Thread-1 (]: 1 of 2 ERROR not_null_stg_products_products_id ................................. [[31mERROR[0m in 0.11s]
[0m12:33:44.052591 [debug] [Thread-1 (]: Finished running node test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec
[0m12:33:44.053255 [debug] [Thread-1 (]: Began running node test.dbt_tp.unique_stg_products_products_id.e8eb11e625
[0m12:33:44.054017 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_products_products_id .............................. [RUN]
[0m12:33:44.055121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_tp.not_null_stg_products_products_id.d6b9a79fec, now test.dbt_tp.unique_stg_products_products_id.e8eb11e625)
[0m12:33:44.055770 [debug] [Thread-1 (]: Began compiling node test.dbt_tp.unique_stg_products_products_id.e8eb11e625
[0m12:33:44.067553 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tp.unique_stg_products_products_id.e8eb11e625"
[0m12:33:44.069729 [debug] [Thread-1 (]: Timing info for test.dbt_tp.unique_stg_products_products_id.e8eb11e625 (compile): 12:33:44.056150 => 12:33:44.069031
[0m12:33:44.070885 [debug] [Thread-1 (]: Began executing node test.dbt_tp.unique_stg_products_products_id.e8eb11e625
[0m12:33:44.074816 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tp.unique_stg_products_products_id.e8eb11e625"
[0m12:33:44.075889 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.unique_stg_products_products_id.e8eb11e625"
[0m12:33:44.076504 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_products_products_id.e8eb11e625: BEGIN
[0m12:33:44.077158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:44.104413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:44.105165 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.unique_stg_products_products_id.e8eb11e625"
[0m12:33:44.105848 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_products_products_id.e8eb11e625: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "test.dbt_tp.unique_stg_products_products_id.e8eb11e625"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    products_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_products"
where products_id is not null
group by products_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:33:44.107871 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "products_id" does not exist
LINE 12:     products_id as unique_field,
             ^
HINT:  Perhaps you meant to reference the column "stg_products.product_id".

[0m12:33:44.108718 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_products_products_id.e8eb11e625: ROLLBACK
[0m12:33:44.111297 [debug] [Thread-1 (]: Timing info for test.dbt_tp.unique_stg_products_products_id.e8eb11e625 (execute): 12:33:44.071332 => 12:33:44.110890
[0m12:33:44.111955 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_products_products_id.e8eb11e625: Close
[0m12:33:44.115803 [debug] [Thread-1 (]: Database Error in test unique_stg_products_products_id (models/staging/models2.yml)
  column "products_id" does not exist
  LINE 12:     products_id as unique_field,
               ^
  HINT:  Perhaps you meant to reference the column "stg_products.product_id".
  compiled Code at target/run/dbt_tp/models/staging/models2.yml/unique_stg_products_products_id.sql
[0m12:33:44.117107 [error] [Thread-1 (]: 2 of 2 ERROR unique_stg_products_products_id ................................... [[31mERROR[0m in 0.06s]
[0m12:33:44.118203 [debug] [Thread-1 (]: Finished running node test.dbt_tp.unique_stg_products_products_id.e8eb11e625
[0m12:33:44.121380 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:44.121929 [debug] [MainThread]: On master: BEGIN
[0m12:33:44.122404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:44.146175 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:33:44.146888 [debug] [MainThread]: On master: COMMIT
[0m12:33:44.147610 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:44.148115 [debug] [MainThread]: On master: COMMIT
[0m12:33:44.149549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:33:44.150291 [debug] [MainThread]: On master: Close
[0m12:33:44.152100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:44.153299 [debug] [MainThread]: Connection 'test.dbt_tp.unique_stg_products_products_id.e8eb11e625' was properly closed.
[0m12:33:44.155040 [info ] [MainThread]: 
[0m12:33:44.155678 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m12:33:44.157448 [debug] [MainThread]: Command end result
[0m12:33:44.173064 [info ] [MainThread]: 
[0m12:33:44.174266 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:33:44.175541 [info ] [MainThread]: 
[0m12:33:44.177170 [error] [MainThread]:   Database Error in test not_null_stg_products_products_id (models/staging/models2.yml)
  column "products_id" does not exist
  LINE 13: select products_id
                  ^
  HINT:  Perhaps you meant to reference the column "stg_products.product_id".
  compiled Code at target/run/dbt_tp/models/staging/models2.yml/not_null_stg_products_products_id.sql
[0m12:33:44.178424 [info ] [MainThread]: 
[0m12:33:44.179816 [error] [MainThread]:   Database Error in test unique_stg_products_products_id (models/staging/models2.yml)
  column "products_id" does not exist
  LINE 12:     products_id as unique_field,
               ^
  HINT:  Perhaps you meant to reference the column "stg_products.product_id".
  compiled Code at target/run/dbt_tp/models/staging/models2.yml/unique_stg_products_products_id.sql
[0m12:33:44.180723 [info ] [MainThread]: 
[0m12:33:44.181862 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m12:33:44.185177 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.525072, "process_user_time": 3.938946, "process_kernel_time": 0.607191, "process_mem_max_rss": "107065344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:33:44.188821 [debug] [MainThread]: Command `dbt test` failed at 12:33:44.188376 after 1.53 seconds
[0m12:33:44.190147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122a68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ce030>]}
[0m12:33:44.190888 [debug] [MainThread]: Flushing usage events
[0m12:34:22.944148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108840440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ffaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108865910>]}


============================== 12:34:22.955023 | 477641a3-9ddf-4444-a1fb-fab6b4ec1912 ==============================
[0m12:34:22.955023 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:34:22.956481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:23.305952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '477641a3-9ddf-4444-a1fb-fab6b4ec1912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc3c50>]}
[0m12:34:23.516361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '477641a3-9ddf-4444-a1fb-fab6b4ec1912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088405f0>]}
[0m12:34:23.518960 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:34:23.658020 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:34:23.761982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:34:23.763207 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/staging/models2.yml
[0m12:34:24.221205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '477641a3-9ddf-4444-a1fb-fab6b4ec1912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109610920>]}
[0m12:34:24.238196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '477641a3-9ddf-4444-a1fb-fab6b4ec1912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109427fb0>]}
[0m12:34:24.239011 [info ] [MainThread]: Found 4 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:34:24.239773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '477641a3-9ddf-4444-a1fb-fab6b4ec1912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b1040>]}
[0m12:34:24.242434 [info ] [MainThread]: 
[0m12:34:24.244118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:34:24.247088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m12:34:24.267817 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:34:24.268478 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:34:24.269132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:24.378502 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:34:24.379226 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:34:24.379807 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:34:24.384863 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:34:24.387488 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:34:24.389326 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:34:24.398614 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:24.399278 [debug] [MainThread]: On master: BEGIN
[0m12:34:24.399896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:24.430001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:34:24.430720 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:24.431346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:34:24.439457 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:34:24.444246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '477641a3-9ddf-4444-a1fb-fab6b4ec1912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e04320>]}
[0m12:34:24.445092 [debug] [MainThread]: On master: ROLLBACK
[0m12:34:24.446887 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:24.447461 [debug] [MainThread]: On master: BEGIN
[0m12:34:24.449842 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:34:24.450579 [debug] [MainThread]: On master: COMMIT
[0m12:34:24.451230 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:24.451916 [debug] [MainThread]: On master: COMMIT
[0m12:34:24.453358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:34:24.453997 [debug] [MainThread]: On master: Close
[0m12:34:24.455460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:24.456145 [info ] [MainThread]: 
[0m12:34:24.460161 [debug] [Thread-1 (]: Began running node test.dbt_tp.not_null_stg_products_product_id.6373b0acf3
[0m12:34:24.460879 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_products_product_id ............................. [RUN]
[0m12:34:24.461911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now test.dbt_tp.not_null_stg_products_product_id.6373b0acf3)
[0m12:34:24.462538 [debug] [Thread-1 (]: Began compiling node test.dbt_tp.not_null_stg_products_product_id.6373b0acf3
[0m12:34:24.498205 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tp.not_null_stg_products_product_id.6373b0acf3"
[0m12:34:24.500246 [debug] [Thread-1 (]: Timing info for test.dbt_tp.not_null_stg_products_product_id.6373b0acf3 (compile): 12:34:24.463506 => 12:34:24.499603
[0m12:34:24.500930 [debug] [Thread-1 (]: Began executing node test.dbt_tp.not_null_stg_products_product_id.6373b0acf3
[0m12:34:24.533398 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tp.not_null_stg_products_product_id.6373b0acf3"
[0m12:34:24.534537 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.not_null_stg_products_product_id.6373b0acf3"
[0m12:34:24.535193 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m12:34:24.535841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:24.560024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:24.560811 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.not_null_stg_products_product_id.6373b0acf3"
[0m12:34:24.561665 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "test.dbt_tp.not_null_stg_products_product_id.6373b0acf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "postgres"."public"."stg_products"
where product_id is null



      
    ) dbt_internal_test
[0m12:34:24.565963 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:34:24.571010 [debug] [Thread-1 (]: Timing info for test.dbt_tp.not_null_stg_products_product_id.6373b0acf3 (execute): 12:34:24.501352 => 12:34:24.570302
[0m12:34:24.572170 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m12:34:24.574049 [debug] [Thread-1 (]: On test.dbt_tp.not_null_stg_products_product_id.6373b0acf3: Close
[0m12:34:24.577907 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_products_product_id ................................... [[32mPASS[0m in 0.11s]
[0m12:34:24.579496 [debug] [Thread-1 (]: Finished running node test.dbt_tp.not_null_stg_products_product_id.6373b0acf3
[0m12:34:24.580591 [debug] [Thread-1 (]: Began running node test.dbt_tp.unique_stg_products_product_id.7d950a1467
[0m12:34:24.581754 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_products_product_id ............................... [RUN]
[0m12:34:24.583396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_tp.not_null_stg_products_product_id.6373b0acf3, now test.dbt_tp.unique_stg_products_product_id.7d950a1467)
[0m12:34:24.584381 [debug] [Thread-1 (]: Began compiling node test.dbt_tp.unique_stg_products_product_id.7d950a1467
[0m12:34:24.614217 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tp.unique_stg_products_product_id.7d950a1467"
[0m12:34:24.618375 [debug] [Thread-1 (]: Timing info for test.dbt_tp.unique_stg_products_product_id.7d950a1467 (compile): 12:34:24.585255 => 12:34:24.617470
[0m12:34:24.620041 [debug] [Thread-1 (]: Began executing node test.dbt_tp.unique_stg_products_product_id.7d950a1467
[0m12:34:24.632005 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tp.unique_stg_products_product_id.7d950a1467"
[0m12:34:24.633784 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.unique_stg_products_product_id.7d950a1467"
[0m12:34:24.634826 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_products_product_id.7d950a1467: BEGIN
[0m12:34:24.635797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:24.673071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:24.673956 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tp.unique_stg_products_product_id.7d950a1467"
[0m12:34:24.674640 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "test.dbt_tp.unique_stg_products_product_id.7d950a1467"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:34:24.677679 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:34:24.680452 [debug] [Thread-1 (]: Timing info for test.dbt_tp.unique_stg_products_product_id.7d950a1467 (execute): 12:34:24.626165 => 12:34:24.680053
[0m12:34:24.681261 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m12:34:24.682674 [debug] [Thread-1 (]: On test.dbt_tp.unique_stg_products_product_id.7d950a1467: Close
[0m12:34:24.684360 [info ] [Thread-1 (]: 2 of 2 PASS unique_stg_products_product_id ..................................... [[32mPASS[0m in 0.10s]
[0m12:34:24.687342 [debug] [Thread-1 (]: Finished running node test.dbt_tp.unique_stg_products_product_id.7d950a1467
[0m12:34:24.690893 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:24.692356 [debug] [MainThread]: On master: BEGIN
[0m12:34:24.693345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:24.730725 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:34:24.731542 [debug] [MainThread]: On master: COMMIT
[0m12:34:24.732092 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:24.732597 [debug] [MainThread]: On master: COMMIT
[0m12:34:24.733906 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:34:24.734530 [debug] [MainThread]: On master: Close
[0m12:34:24.736011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:24.737207 [debug] [MainThread]: Connection 'test.dbt_tp.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m12:34:24.738846 [info ] [MainThread]: 
[0m12:34:24.739956 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m12:34:24.741544 [debug] [MainThread]: Command end result
[0m12:34:24.764730 [info ] [MainThread]: 
[0m12:34:24.765737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:24.766860 [info ] [MainThread]: 
[0m12:34:24.767742 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:34:24.773760 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9188709, "process_user_time": 4.305709, "process_kernel_time": 0.610099, "process_mem_max_rss": "109006848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:34:24.776419 [debug] [MainThread]: Command `dbt test` succeeded at 12:34:24.775664 after 1.92 seconds
[0m12:34:24.777608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109427ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109807e90>]}
[0m12:34:24.778504 [debug] [MainThread]: Flushing usage events
[0m12:59:24.352963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe06420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe31fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe31d30>]}


============================== 12:59:24.364144 | 41f5f6c7-ce93-45f1-bfb3-ebd9333fd071 ==============================
[0m12:59:24.364144 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:59:24.365601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select daily_sales_revenue_by_category', 'send_anonymous_usage_stats': 'True'}
[0m12:59:24.725650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f5f6c7-ce93-45f1-bfb3-ebd9333fd071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11036e4e0>]}
[0m12:59:24.854561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f5f6c7-ce93-45f1-bfb3-ebd9333fd071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11036f560>]}
[0m12:59:24.856900 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:59:24.896332 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:59:25.004678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:59:25.005521 [debug] [MainThread]: Partial parsing: added file: dbt_tp://models/marts/daily_sales_volume.sql
[0m12:59:25.006053 [debug] [MainThread]: Partial parsing: added file: dbt_tp://models/marts/daily_sales_revenue_by_category.sql
[0m12:59:25.255220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41f5f6c7-ce93-45f1-bfb3-ebd9333fd071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042e360>]}
[0m12:59:25.272584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41f5f6c7-ce93-45f1-bfb3-ebd9333fd071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11048c9b0>]}
[0m12:59:25.273484 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:59:25.274166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f5f6c7-ce93-45f1-bfb3-ebd9333fd071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103c1f70>]}
[0m12:59:25.276683 [info ] [MainThread]: 
[0m12:59:25.278092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:59:25.279759 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:59:25.301475 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:59:25.303807 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:59:25.304888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:25.421912 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:59:25.424175 [debug] [ThreadPool]: On list_postgres: Close
[0m12:59:25.427990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:59:25.439824 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:59:25.440581 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:59:25.441475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:25.464547 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:59:25.465356 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:59:25.466598 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:59:25.472036 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:59:25.474283 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:59:25.475780 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:59:25.485762 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:25.486392 [debug] [MainThread]: On master: BEGIN
[0m12:59:25.486911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:25.508231 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:59:25.508948 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:25.509795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:25.517774 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:59:25.520350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f5f6c7-ce93-45f1-bfb3-ebd9333fd071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d37ce0>]}
[0m12:59:25.521519 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:25.523038 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:25.523625 [debug] [MainThread]: On master: BEGIN
[0m12:59:25.525892 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:59:25.526691 [debug] [MainThread]: On master: COMMIT
[0m12:59:25.527219 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:25.527683 [debug] [MainThread]: On master: COMMIT
[0m12:59:25.529178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:59:25.529808 [debug] [MainThread]: On master: Close
[0m12:59:25.531327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:25.531990 [info ] [MainThread]: 
[0m12:59:25.536735 [debug] [Thread-1 (]: Began running node model.dbt_tp.daily_sales_revenue_by_category
[0m12:59:25.537724 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m12:59:25.538769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.daily_sales_revenue_by_category)
[0m12:59:25.539765 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.daily_sales_revenue_by_category
[0m12:59:25.574780 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.daily_sales_revenue_by_category"
[0m12:59:25.577369 [debug] [Thread-1 (]: Timing info for model.dbt_tp.daily_sales_revenue_by_category (compile): 12:59:25.540495 => 12:59:25.576473
[0m12:59:25.578374 [debug] [Thread-1 (]: Began executing node model.dbt_tp.daily_sales_revenue_by_category
[0m12:59:25.651201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.daily_sales_revenue_by_category"
[0m12:59:25.653883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m12:59:25.654510 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: BEGIN
[0m12:59:25.655068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:25.679029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:59:25.679811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m12:59:25.680382 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select sum(s.quantity*p.price) as daily_revenue
from "postgres"."public"."stg_sales" as s
inner join "postgres"."public"."stg_products" as p on s.product_id = p.product_id
  );
  
[0m12:59:25.709050 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:59:25.718314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m12:59:25.719132 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */
alter table "postgres"."public"."daily_sales_revenue_by_category" rename to "daily_sales_revenue_by_category__dbt_backup"
[0m12:59:25.721197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:59:25.728896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m12:59:25.729799 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */
alter table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp" rename to "daily_sales_revenue_by_category"
[0m12:59:25.731491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:59:25.762749 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: COMMIT
[0m12:59:25.763694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m12:59:25.764340 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: COMMIT
[0m12:59:25.769255 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:59:25.778732 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."daily_sales_revenue_by_category__dbt_backup"
[0m12:59:25.786954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m12:59:25.787635 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */
drop table if exists "postgres"."public"."daily_sales_revenue_by_category__dbt_backup" cascade
[0m12:59:25.795712 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:59:25.798508 [debug] [Thread-1 (]: Timing info for model.dbt_tp.daily_sales_revenue_by_category (execute): 12:59:25.578763 => 12:59:25.797957
[0m12:59:25.799171 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: Close
[0m12:59:25.801157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f5f6c7-ce93-45f1-bfb3-ebd9333fd071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d49ee0>]}
[0m12:59:25.806279 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.daily_sales_revenue_by_category ....... [[32mSELECT 1[0m in 0.26s]
[0m12:59:25.807958 [debug] [Thread-1 (]: Finished running node model.dbt_tp.daily_sales_revenue_by_category
[0m12:59:25.811778 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:25.812543 [debug] [MainThread]: On master: BEGIN
[0m12:59:25.813146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:25.854809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:59:25.855630 [debug] [MainThread]: On master: COMMIT
[0m12:59:25.856412 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:25.856928 [debug] [MainThread]: On master: COMMIT
[0m12:59:25.859113 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:59:25.859835 [debug] [MainThread]: On master: Close
[0m12:59:25.861495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:25.862329 [debug] [MainThread]: Connection 'model.dbt_tp.daily_sales_revenue_by_category' was properly closed.
[0m12:59:25.863355 [info ] [MainThread]: 
[0m12:59:25.864539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m12:59:25.866569 [debug] [MainThread]: Command end result
[0m12:59:25.884882 [info ] [MainThread]: 
[0m12:59:25.887481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:25.889176 [info ] [MainThread]: 
[0m12:59:25.890659 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:59:25.895861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.637887, "process_user_time": 4.00056, "process_kernel_time": 0.662796, "process_mem_max_rss": "108224512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:59:25.896906 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:25.896661 after 1.64 seconds
[0m12:59:25.898512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7fa570>]}
[0m12:59:25.899481 [debug] [MainThread]: Flushing usage events
[0m13:05:13.765465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1d3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b202000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b201d30>]}


============================== 13:05:13.777467 | eb29a44d-d135-49ca-8ae0-9fcdc0cc1212 ==============================
[0m13:05:13.777467 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:05:13.778660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/estelleclement/.dbt', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select daily_sales_revenue_by_category', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:05:14.135155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb29a44d-d135-49ca-8ae0-9fcdc0cc1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b73e9c0>]}
[0m13:05:14.375638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb29a44d-d135-49ca-8ae0-9fcdc0cc1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b76e0>]}
[0m13:05:14.377959 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m13:05:14.422067 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:05:14.529275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:14.530208 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/marts/daily_sales_revenue_by_category.sql
[0m13:05:14.806115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb29a44d-d135-49ca-8ae0-9fcdc0cc1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b82d280>]}
[0m13:05:14.824592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb29a44d-d135-49ca-8ae0-9fcdc0cc1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b85ca40>]}
[0m13:05:14.825299 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:05:14.825909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb29a44d-d135-49ca-8ae0-9fcdc0cc1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c8200>]}
[0m13:05:14.829488 [info ] [MainThread]: 
[0m13:05:14.831705 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:14.833434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:05:14.851834 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:05:14.852988 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:05:14.853547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:15.004154 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:05:15.008831 [debug] [ThreadPool]: On list_postgres: Close
[0m13:05:15.016808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m13:05:15.032735 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:05:15.033364 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m13:05:15.033911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:15.059529 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:05:15.060579 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:05:15.063309 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:05:15.068043 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:05:15.071616 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m13:05:15.072991 [debug] [ThreadPool]: On list_postgres_public: Close
[0m13:05:15.083576 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:15.084195 [debug] [MainThread]: On master: BEGIN
[0m13:05:15.084911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:15.107261 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:15.107935 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:15.108610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:15.118971 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m13:05:15.121995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb29a44d-d135-49ca-8ae0-9fcdc0cc1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7fa0f0>]}
[0m13:05:15.122875 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:15.125231 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:15.126693 [debug] [MainThread]: On master: BEGIN
[0m13:05:15.129801 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:15.130395 [debug] [MainThread]: On master: COMMIT
[0m13:05:15.130983 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:15.131440 [debug] [MainThread]: On master: COMMIT
[0m13:05:15.132914 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:05:15.134468 [debug] [MainThread]: On master: Close
[0m13:05:15.136121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:15.136776 [info ] [MainThread]: 
[0m13:05:15.143646 [debug] [Thread-1 (]: Began running node model.dbt_tp.daily_sales_revenue_by_category
[0m13:05:15.145150 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m13:05:15.146306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.daily_sales_revenue_by_category)
[0m13:05:15.146958 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.daily_sales_revenue_by_category
[0m13:05:15.170151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:05:15.171333 [debug] [Thread-1 (]: Timing info for model.dbt_tp.daily_sales_revenue_by_category (compile): 13:05:15.147337 => 13:05:15.170964
[0m13:05:15.171989 [debug] [Thread-1 (]: Began executing node model.dbt_tp.daily_sales_revenue_by_category
[0m13:05:15.260860 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:05:15.262139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:05:15.262937 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: BEGIN
[0m13:05:15.263495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:15.284125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:05:15.284877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:05:15.285433 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select s.sale_date, p.category ,sum(s.quantity*p.price) as daily_revenue
from "postgres"."public"."stg_sales" as s
inner join "postgres"."public"."stg_products" as p on s.product_id = p.product_id
  );
  
[0m13:05:15.291819 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "s.sale_date" must appear in the GROUP BY clause or be used in an aggregate function
LINE 14: select s.sale_date, p.category ,sum(s.quantity*p.price) as d...
                ^

[0m13:05:15.292859 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: ROLLBACK
[0m13:05:15.294792 [debug] [Thread-1 (]: Timing info for model.dbt_tp.daily_sales_revenue_by_category (execute): 13:05:15.172357 => 13:05:15.294360
[0m13:05:15.295553 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: Close
[0m13:05:15.310271 [debug] [Thread-1 (]: Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  column "s.sale_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 14: select s.sale_date, p.category ,sum(s.quantity*p.price) as d...
                  ^
  compiled Code at target/run/dbt_tp/models/marts/daily_sales_revenue_by_category.sql
[0m13:05:15.311129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb29a44d-d135-49ca-8ae0-9fcdc0cc1212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf5f710>]}
[0m13:05:15.313463 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.17s]
[0m13:05:15.314753 [debug] [Thread-1 (]: Finished running node model.dbt_tp.daily_sales_revenue_by_category
[0m13:05:15.317341 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:15.318086 [debug] [MainThread]: On master: BEGIN
[0m13:05:15.318795 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:15.350677 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:15.351354 [debug] [MainThread]: On master: COMMIT
[0m13:05:15.351876 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:15.352333 [debug] [MainThread]: On master: COMMIT
[0m13:05:15.353937 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:05:15.354611 [debug] [MainThread]: On master: Close
[0m13:05:15.355864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:15.356742 [debug] [MainThread]: Connection 'model.dbt_tp.daily_sales_revenue_by_category' was properly closed.
[0m13:05:15.357642 [info ] [MainThread]: 
[0m13:05:15.358521 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m13:05:15.359717 [debug] [MainThread]: Command end result
[0m13:05:15.373073 [info ] [MainThread]: 
[0m13:05:15.373732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:05:15.374382 [info ] [MainThread]: 
[0m13:05:15.374968 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  column "s.sale_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 14: select s.sale_date, p.category ,sum(s.quantity*p.price) as d...
                  ^
  compiled Code at target/run/dbt_tp/models/marts/daily_sales_revenue_by_category.sql
[0m13:05:15.375691 [info ] [MainThread]: 
[0m13:05:15.376280 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:05:15.381048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7093719, "process_user_time": 4.08699, "process_kernel_time": 0.67948, "process_mem_max_rss": "107167744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:05:15.382122 [debug] [MainThread]: Command `dbt run` failed at 13:05:15.381826 after 1.71 seconds
[0m13:05:15.382944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac509b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c8e90>]}
[0m13:05:15.383806 [debug] [MainThread]: Flushing usage events
[0m13:06:22.424740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a199040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ca0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c9e50>]}


============================== 13:06:22.435740 | 188b6101-cd36-4d8a-8f54-742faa119e24 ==============================
[0m13:06:22.435740 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:06:22.436853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/exercise-main-noelie-comte/dbt_tp/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select daily_sales_revenue_by_category', 'send_anonymous_usage_stats': 'True'}
[0m13:06:22.807641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '188b6101-cd36-4d8a-8f54-742faa119e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1f02c0>]}
[0m13:06:22.944304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '188b6101-cd36-4d8a-8f54-742faa119e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7995e0>]}
[0m13:06:22.946587 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m13:06:22.988001 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:06:23.091440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:06:23.092365 [debug] [MainThread]: Partial parsing: updated file: dbt_tp://models/marts/daily_sales_revenue_by_category.sql
[0m13:06:23.299811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '188b6101-cd36-4d8a-8f54-742faa119e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c9c40>]}
[0m13:06:23.316650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '188b6101-cd36-4d8a-8f54-742faa119e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a825280>]}
[0m13:06:23.317369 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:06:23.318379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '188b6101-cd36-4d8a-8f54-742faa119e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae68ad0>]}
[0m13:06:23.320589 [info ] [MainThread]: 
[0m13:06:23.321838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:06:23.323266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:06:23.342336 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:06:23.343138 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:06:23.344071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:23.448458 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:06:23.450721 [debug] [ThreadPool]: On list_postgres: Close
[0m13:06:23.454332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m13:06:23.462721 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:06:23.463327 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m13:06:23.463779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:23.482424 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:06:23.483386 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:06:23.483998 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:06:23.488749 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:06:23.490810 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m13:06:23.492262 [debug] [ThreadPool]: On list_postgres_public: Close
[0m13:06:23.502071 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:23.502710 [debug] [MainThread]: On master: BEGIN
[0m13:06:23.503318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:23.523053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:06:23.523830 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:23.524500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:06:23.531296 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m13:06:23.533723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '188b6101-cd36-4d8a-8f54-742faa119e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae866f0>]}
[0m13:06:23.534388 [debug] [MainThread]: On master: ROLLBACK
[0m13:06:23.535970 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:23.536539 [debug] [MainThread]: On master: BEGIN
[0m13:06:23.538484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:06:23.539226 [debug] [MainThread]: On master: COMMIT
[0m13:06:23.539746 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:23.540240 [debug] [MainThread]: On master: COMMIT
[0m13:06:23.541562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:06:23.542206 [debug] [MainThread]: On master: Close
[0m13:06:23.543860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:06:23.544498 [info ] [MainThread]: 
[0m13:06:23.548839 [debug] [Thread-1 (]: Began running node model.dbt_tp.daily_sales_revenue_by_category
[0m13:06:23.549652 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m13:06:23.551378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.dbt_tp.daily_sales_revenue_by_category)
[0m13:06:23.552401 [debug] [Thread-1 (]: Began compiling node model.dbt_tp.daily_sales_revenue_by_category
[0m13:06:23.568851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:06:23.572959 [debug] [Thread-1 (]: Timing info for model.dbt_tp.daily_sales_revenue_by_category (compile): 13:06:23.553157 => 13:06:23.572204
[0m13:06:23.573717 [debug] [Thread-1 (]: Began executing node model.dbt_tp.daily_sales_revenue_by_category
[0m13:06:23.652281 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:06:23.653586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:06:23.654181 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: BEGIN
[0m13:06:23.654729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:23.674486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:06:23.675297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:06:23.675878 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select s.sale_date, p.category ,sum(s.quantity*p.price) as daily_revenue
from "postgres"."public"."stg_sales" as s
inner join "postgres"."public"."stg_products" as p on s.product_id = p.product_id
group by s.sale_date, p.category
  );
  
[0m13:06:23.697236 [debug] [Thread-1 (]: SQL status: SELECT 169 in 0.0 seconds
[0m13:06:23.706329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:06:23.707127 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */
alter table "postgres"."public"."daily_sales_revenue_by_category" rename to "daily_sales_revenue_by_category__dbt_backup"
[0m13:06:23.708914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:06:23.712885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:06:23.713477 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */
alter table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp" rename to "daily_sales_revenue_by_category"
[0m13:06:23.715463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:06:23.742773 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: COMMIT
[0m13:06:23.743834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:06:23.744423 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: COMMIT
[0m13:06:23.753733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:06:23.764320 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."daily_sales_revenue_by_category__dbt_backup"
[0m13:06:23.772665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tp.daily_sales_revenue_by_category"
[0m13:06:23.773458 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_tp", "target_name": "dev", "node_id": "model.dbt_tp.daily_sales_revenue_by_category"} */
drop table if exists "postgres"."public"."daily_sales_revenue_by_category__dbt_backup" cascade
[0m13:06:23.778363 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:06:23.780524 [debug] [Thread-1 (]: Timing info for model.dbt_tp.daily_sales_revenue_by_category (execute): 13:06:23.574621 => 13:06:23.780199
[0m13:06:23.781159 [debug] [Thread-1 (]: On model.dbt_tp.daily_sales_revenue_by_category: Close
[0m13:06:23.782312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '188b6101-cd36-4d8a-8f54-742faa119e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae69280>]}
[0m13:06:23.783252 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.daily_sales_revenue_by_category ....... [[32mSELECT 169[0m in 0.23s]
[0m13:06:23.785059 [debug] [Thread-1 (]: Finished running node model.dbt_tp.daily_sales_revenue_by_category
[0m13:06:23.787338 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:23.787898 [debug] [MainThread]: On master: BEGIN
[0m13:06:23.788352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:06:23.831421 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:06:23.832313 [debug] [MainThread]: On master: COMMIT
[0m13:06:23.832847 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:23.833523 [debug] [MainThread]: On master: COMMIT
[0m13:06:23.835442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:06:23.836359 [debug] [MainThread]: On master: Close
[0m13:06:23.839281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:23.840529 [debug] [MainThread]: Connection 'model.dbt_tp.daily_sales_revenue_by_category' was properly closed.
[0m13:06:23.841516 [info ] [MainThread]: 
[0m13:06:23.842172 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m13:06:23.843924 [debug] [MainThread]: Command end result
[0m13:06:23.862210 [info ] [MainThread]: 
[0m13:06:23.863814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:06:23.865791 [info ] [MainThread]: 
[0m13:06:23.867265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:06:23.876984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5422021, "process_user_time": 3.934079, "process_kernel_time": 0.58667, "process_mem_max_rss": "106848256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:06:23.878690 [debug] [MainThread]: Command `dbt run` succeeded at 13:06:23.878202 after 1.54 seconds
[0m13:06:23.881937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ccfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f84c80>]}
[0m13:06:23.882982 [debug] [MainThread]: Flushing usage events
